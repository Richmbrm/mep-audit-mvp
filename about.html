<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>App Summary | MEP Audit Viewer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/src/style.css">
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'dark' });
    </script>
    <style>
        .summary-card {
            background: var(--color-bg-light);
            border: 1px solid var(--color-border);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .tech-tag {
            background: var(--color-bg);
            padding: 0.25rem 0.75rem;
            border-radius: 2rem;
            font-size: 0.75rem;
            border: 1px solid var(--color-border);
            color: var(--color-primary);
            font-weight: 600;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--color-primary);
            text-decoration: none;
            font-weight: 600;
            margin-bottom: 2rem;
            transition: transform 0.2s;
        }

        .back-link:hover {
            transform: translateX(-5px);
        }
    </style>
</head>

<body>
    <div id="app">
        <div class="beta-banner">
            <span class="beta-tag">BETA MVP</span>
            <span class="version-tag">v1.5</span>
            <span class="banner-msg">Continuous Improvement in Progress</span>
        </div>

        <header style="margin-bottom: 2rem;">
            <a href="index.html" class="back-link">‚Üê Back to Dashboard</a>
            <h1>App Architecture & Data Flow</h1>
            <p style="color: var(--color-text-dim); display: flex; align-items: center; gap: 1rem;">
                Technical summary of the MEP Audit Viewer infrastructure
                <a href="management.html"
                    style="font-size: 0.7rem; color: var(--color-warning); text-decoration: none; border: 1px solid var(--color-warning); padding: 0.1rem 0.6rem; border-radius: 4px; font-weight: 600; text-transform: uppercase;">Management</a>
            </p>
        </header>

        <main>
            <section class="summary-card animate-in">
                <h2>Core Ingestion & Processing</h2>
                <p>The system is designed to validate MEP (Mechanical, Electrical, and Plumbing) installations against
                    ISO 14644 and engineering standards.</p>
                <div class="summary-grid">
                    <div>
                        <h3>üì• Data Ingested</h3>
                        <ul style="color: var(--color-text-dim); line-height: 1.8;">
                            <li><strong>Room Schedules:</strong> CSV/ODS files containing room dimensions, air change
                                requirements, and ISO classifications.</li>
                            <li><strong>Component Inventories:</strong> Equipment lists, AHU specifications, and
                                filtration data.</li>
                            <li><strong>Regulatory Manuals (PDF):</strong> Direct ingestion of "Gold Standard" manuals
                                (FDA Guidance, WHO Sterile GMP, EU GMP Annex 1).</li>
                        </ul>
                    </div>
                    <div>
                        <h3>üì§ Data Output</h3>
                        <ul style="color: var(--color-text-dim); line-height: 1.8;">
                            <li><strong>Interactive Dashboards:</strong> Real-time visualization of pass/fail compliance
                                metrics.</li>
                            <li><strong>Validation Logs:</strong> JSON-formatted audit reports with deep technical
                                analysis.</li>
                            <li><strong>AI Experts:</strong> Automated compliance insights and engineering
                                recommendations.</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section class="summary-card animate-in" style="border-left: 4px solid var(--color-warning);">
                <h2>Regulatory RAG (Vector Vault)</h2>
                <p>The system utilizes <strong>Retrieval-Augmented Generation (RAG)</strong> to query precise technical
                    data from thousands of pages of regulatory documentation.</p>
                <div class="summary-grid">
                    <div>
                        <h3>üî¨ Vector Infrastructure</h3>
                        <p style="font-size: 0.9rem; color: var(--color-text-dim);">
                            <strong>ChromaDB:</strong> A high-performance local vector store used to index 591 technical
                            snippets from <strong>FDA</strong>, <strong>EU GMP</strong>, and <strong>WHO TRS
                                961</strong> manuals.<br><br>
                            <strong>Nomic-Embed-Text:</strong> The local embedding model that converts technical text
                            into searchable multidimensional vectors.
                        </p>
                    </div>
                    <div>
                        <h3>üõ°Ô∏è Local Compliance</h3>
                        <p style="font-size: 0.9rem; color: var(--color-text-dim);">
                            Search is now <strong>100% Local</strong>. External tiers (Wikipedia, global deep search)
                            have been deactivated to prioritize privacy, speed, and offline consistency.
                        </p>
                    </div>
                </div>
            </section>

            <section class="summary-card animate-in" style="border-left: 4px solid var(--color-primary);">
                <h2>Local LLM Intelligence (Ollama)</h2>
                <p>The "AI Standards Insight" feature utilizes locally hosted Large Language Models to provide deep
                    reasoning without external data leakage.</p>
                <div class="summary-grid">
                    <div>
                        <h3>üß† Models Used</h3>
                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1rem;">
                            <span class="tech-tag">cniongolo/biomistral:latest</span>
                            <span class="tech-tag">llama3.2:latest</span>
                            <span class="tech-tag">nomic-embed-text:latest</span>
                        </div>
                        <p style="font-size: 0.9rem; color: var(--color-text-dim);">
                            <strong>BioMistral:</strong> Used for specialized scientific, cleanroom, and medical-grade
                            MEP filtration insights.<br><br>
                            <strong>Llama 3.2:</strong> Utilized for general engineering reasoning, regulatory logic,
                            and formatting.
                        </p>
                    </div>
                    <div>
                        <h3>üìç Local Location</h3>
                        <p style="font-size: 0.9rem; color: var(--color-text-dim);">
                            The models are served via <strong>Ollama</strong> on the local loopback interface:<br>
                            <code>http://127.0.0.1:11434</code><br><br>
                            <em>Note: The backend proxy in <code>server.js</code> bridges the web interface to this
                                secure local endpoint.</em>
                        </p>
                    </div>
                </div>
            </section>

            <section class="summary-card animate-in" style="border-left: 4px solid #8b5cf6;">
                <h2>System Architecture Node Map</h2>
                <p>Visualization of the 100% local data circuit and node associations.</p>

                <div class="mermaid"
                    style="background: rgba(0,0,0,0.2); border-radius: 8px; padding: 1.25rem; margin: 1.5rem 0; overflow: hidden; display: flex; justify-content: center;">
                    graph TD
                    User["üåê User Browser (Vite/JS)"]
                    Server["üöÄ Node.js Server (Express)"]
                    Python["üêç Python Audit Engine"]
                    Vector["üì¶ ChromaDB (Vector Store)"]
                    Ollama["ü¶ô Ollama API (v11434)"]

                    subgraph Models ["LLM Model Nodes"]
                    BM["üß™ BioMistral (MEP Expert)"]
                    LLM["ü§ñ Llama 3.2 (Reasoning)"]
                    NOM["üìë Nomic-Embed (RAG)"]
                    end

                    User ---|"REST API (JSON)"| Server
                    Server --->|"Exec Process"| Python
                    Server ---|"Query Bridge"| Vector
                    Server ---|"Undici Proxy"| Ollama
                    Ollama --> BM
                    Ollama --> LLM
                    Ollama --> NOM

                    style User fill:#3b82f6,stroke:#fff,stroke-width:2px
                    style Server fill:#10b981,stroke:#fff,stroke-width:2px
                    style Models fill:#1e293b,stroke:#8b5cf6,stroke-width:2px
                </div>

                <div class="summary-grid">
                    <div>
                        <h3>üîó Node Associations</h3>
                        <ul style="color: var(--color-text-dim); font-size: 0.9rem; line-height: 1.6;">
                            <li><strong>Frontend ‚Üí Backend:</strong> Secured via local CORS; handles audit triggers,
                                file uploads, and AI queries.</li>
                            <li><strong>Backend ‚Üí Python:</strong> Orchestrates the technical validation logic and
                                regulatory RAG ingestion engine.</li>
                            <li><strong>Backend ‚Üí Ollama:</strong> Bridges the web interface to local model weights via
                                high-timeout proxying.</li>
                            <li><strong>Ollama ‚Üí Models:</strong> Dynamically serves and manages the three active model
                                nodes in local memory.</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section class="summary-card animate-in">
                <h2>Tech Stack Summary</h2>
                <p style="color: var(--color-text-dim);">
                    <strong>Backend:</strong> Node.js & Express.js (v5.0+)<br>
                    <strong>Frontend:</strong> Vite, Vanilla JS, CSS Variables<br>
                    <strong>Audit Engine:</strong> Python 3.x (Validation Script)<br>
                    <strong>Deployment:</strong> Render.com (Web) & Local Machine (LLM Processing)
                </p>
            </section>
        </main>

        <footer style="text-align: center; padding: 2rem; color: var(--color-text-dim); font-size: 0.8rem;">
            MEP Audit Solutions Dashboard ‚Ä¢ 2025 Architecture Summary
        </footer>
    </div>
</body>

</html>